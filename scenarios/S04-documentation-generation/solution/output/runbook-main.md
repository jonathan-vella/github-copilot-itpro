# Operational Runbook: main

**Generated**: 2025-11-20 17:19:06  
**Template**: main  
**Format**: Bicep  
**Auto-generated by**: GitHub Copilot + PowerShell

---

## Overview

This runbook provides comprehensive operational procedures for deploying and managing the infrastructure defined in **main**.

**Resources Deployed**: 

---

## Prerequisites

- ✅ Azure subscription with Contributor access
- ✅ Azure CLI or PowerShell Az module installed
- ✅ Bicep CLI (for Bicep templates)
- ✅ Resource providers registered
- ✅ Required RBAC permissions assigned

---
## Deployment Procedure

### Step 1: Validate Template

```powershell
# Validate Bicep template
az deployment group validate \
    --resource-group <resource-group-name> \
    --template-file main.bicep \
    --parameters @parameters.json
```

### Step 2: What-If Deployment

```powershell
# Preview changes
az deployment group what-if \
    --resource-group <resource-group-name> \
    --template-file main.bicep \
    --parameters @parameters.json
```

### Step 3: Deploy Infrastructure

```powershell
# Deploy with verbose logging
az deployment group create \
    --resource-group <resource-group-name> \
    --template-file main.bicep \
    --parameters @parameters.json \
    --verbose
```

### Step 4: Verify Deployment

```powershell
# Check deployment status
az deployment group show \
    --resource-group <resource-group-name> \
    --name <deployment-name>
```

---
## Post-Deployment Validation

### Validation Checklist

- [ ] All resources deployed successfully
- [ ] Resource group tags applied correctly
- [ ] Network connectivity verified
- [ ] Security settings configured
- [ ] Monitoring and alerts enabled
- [ ] Backup policies configured
- [ ] Access controls validated

### Automated Validation Script

```powershell
# Validate deployed resources
$resources = Get-AzResource -ResourceGroupName <resource-group-name>
$resources | ForEach-Object {
    Write-Host "✅ $($_.Name) - $($_.ResourceType)" -ForegroundColor Green
}

# Test connectivity
Test-NetConnection -ComputerName <endpoint> -Port 443
```

---
## Troubleshooting Guide

### Common Issues

#### Issue: Deployment Timeout
**Symptoms**: Deployment exceeds 1-hour timeout  
**Cause**: Large resource deployments or dependency conflicts  
**Resolution**:
1. Break deployment into smaller modules
2. Check for circular dependencies
3. Increase timeout with --timeout parameter

#### Issue: Resource Provider Not Registered
**Symptoms**: Error "The subscription is not registered"  
**Resolution**:
```powershell
az provider register --namespace Microsoft.Storage
az provider show --namespace Microsoft.Storage --query "registrationState"
```

#### Issue: Insufficient Permissions
**Symptoms**: Authorization failed errors  
**Resolution**:
1. Verify RBAC assignments: z role assignment list
2. Ensure Contributor or Owner role
3. Check resource provider permissions

---
## Operational Tasks

### Daily Operations
- Monitor resource health in Azure Portal
- Review cost analysis and spending trends
- Check Azure Advisor recommendations
- Verify backup completion status

### Weekly Operations
- Review and apply security updates
- Analyze performance metrics
- Validate disaster recovery procedures
- Update documentation for changes

### Monthly Operations
- Conduct security audit
- Review and optimize costs
- Test disaster recovery plan
- Update runbooks and procedures

---

## Rollback Procedure

### Emergency Rollback

```powershell
# Delete failed deployment
az deployment group delete \
    --resource-group <resource-group-name> \
    --name <deployment-name>

# Redeploy previous version
az deployment group create \
    --resource-group <resource-group-name> \
    --template-file main.bicep \
    --parameters @parameters-previous.json
```

---

## Monitoring & Alerts

### Key Metrics
- Resource availability (uptime %)
- Performance metrics (CPU, memory, latency)
- Error rates and failed requests
- Cost per day/month

### Recommended Alerts
- Resource health degraded
- Cost threshold exceeded (80% of budget)
- Failed deployment operations
- Security policy violations

---

## Additional Resources

- [Azure Deployment Best Practices](https://learn.microsoft.com/azure/azure-resource-manager/templates/best-practices)
- [Bicep Documentation](https://learn.microsoft.com/azure/azure-resource-manager/bicep/)
- [Azure Monitor](https://learn.microsoft.com/azure/azure-monitor/)

---

*Auto-generated runbook by GitHub Copilot. Last updated: 2025-11-20 17:19:06*
