# Generate Azure Architecture Documentation

Please create comprehensive **Architecture Documentation** for the following Azure resources in resource group **rg-contoso-patient-portal-dev**:

## Deployed Resources

- **Microsoft.Network/networkInterfaces** (2 instance(s))
  - Name: `pe-sqlserver-dev-qkfwso.nic.2452ca69-7f5e-4505-b393-c8087fa23188`, Location: `swedencentral`
  - Name: `pe-keyvault-dev-qkfwso.nic.caf77a4e-ae78-4d34-89d4-17f3838ecd40`, Location: `swedencentral`
- **Microsoft.Network/networkSecurityGroups** (2 instance(s))
  - Name: `nsg-data-dev-qkfwso`, Location: `swedencentral`
  - Name: `nsg-web-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.Network/privateDnsZones** (2 instance(s))
  - Name: `privatelink.database.windows.net`, Location: `global`
  - Name: `privatelink.vaultcore.azure.net`, Location: `global`
- **Microsoft.Network/privateDnsZones/virtualNetworkLinks** (2 instance(s))
  - Name: `privatelink.database.windows.net/link-to-vnet`, Location: `global`
  - Name: `privatelink.vaultcore.azure.net/link-to-vnet`, Location: `global`
- **Microsoft.Network/privateEndpoints** (2 instance(s))
  - Name: `pe-keyvault-dev-qkfwso`, Location: `swedencentral`
  - Name: `pe-sqlserver-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.Sql/servers/databases** (2 instance(s))
  - Name: `sql-contosopat-dev-qkfwso/master`, SKU: `GP_SYSTEM`, Location: `swedencentral`
  - Name: `sql-contosopat-dev-qkfwso/sqldb-patients-dev-qkfwso`, SKU: `Standard`, Location: `swedencentral`
- **microsoft.alertsmanagement/smartDetectorAlertRules** (1 instance(s))
  - Name: `Failure Anomalies - appi-contosopa-dev-qkfwso`, Location: `global`
- **Microsoft.Insights/components** (1 instance(s))
  - Name: `appi-contosopa-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.KeyVault/vaults** (1 instance(s))
  - Name: `kv-contosop-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.Network/virtualNetworks** (1 instance(s))
  - Name: `vnet-contosopat-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.OperationalInsights/workspaces** (1 instance(s))
  - Name: `log-contosopat-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.Sql/servers** (1 instance(s))
  - Name: `sql-contosopat-dev-qkfwso`, Location: `swedencentral`
- **Microsoft.Web/serverFarms** (1 instance(s))
  - Name: `asp-contosopat-dev-qkfwso`, SKU: `P1v3`, Location: `swedencentral`
- **Microsoft.Web/sites** (1 instance(s))
  - Name: `app-contosopat-dev-qkfwso`, Location: `swedencentral`


## Required Documentation Sections

### 1. Executive Summary
- **Purpose**: Brief description of what this infrastructure supports
- **Environment**: Development, Staging, or Production
- **Key Services**: Highlight the primary services (e.g., App Service, SQL Database, Storage)
- **Architecture Pattern**: Describe the pattern (e.g., 3-tier web app, microservices, data pipeline)

### 2. Resource Inventory

Create a comprehensive table of all resources:

| Resource Name | Resource Type | SKU/Tier | Location | Purpose | Dependencies |
|--------------|---------------|----------|----------|---------|--------------|
| (for each resource) | | | | | |

### 3. Architecture Overview

Provide a narrative description of:
- **Application Flow**: How requests flow through the system
- **Data Flow**: How data moves between components
- **Security Boundaries**: Network isolation, private endpoints, NSGs
- **High Availability**: Zone redundancy, backup strategies
- **Scaling Strategy**: Auto-scaling configuration, manual scaling procedures


### 4. Architecture Diagrams (Mermaid)

Generate Mermaid diagrams for visualization:

#### System Architecture Diagram
Create a high-level Mermaid diagram showing:
- User/client access points
- Load balancers or Application Gateways
- Web tier (App Services, Container Apps)
- Application tier (Function Apps, APIs)
- Data tier (SQL Database, Cosmos DB, Storage)
- Supporting services (Key Vault, Application Insights, Log Analytics)
- External integrations

Example format:
```mermaid
graph TB
    User[Users/Clients]
    AppGW[Application Gateway]
    WebApp[App Service]
    API[Function App]
    DB[(SQL Database)]
    KV[Key Vault]
    AppI[Application Insights]
    
    User -->|HTTPS| AppGW
    AppGW -->|Port 443| WebApp
    WebApp -->|API Calls| API
    API -->|Query| DB
    WebApp -.->|Secrets| KV
    WebApp -.->|Telemetry| AppI
```


### 5. Network Topology

Document the network architecture:

#### Virtual Networks
- VNet address spaces and subnets
- Subnet purposes (web tier, app tier, data tier)
- NSG rules summary
- Service endpoints or private endpoints
- VNet peering or VPN connections

#### Network Security
- NSG rules table (priority, source, destination, port, action)
- Private endpoint configurations
- Private DNS zones
- Firewall rules (if applicable)

#### Connectivity Diagram (Mermaid)
Create a network topology diagram:
```mermaid
graph LR
    Internet((Internet))
    VNet[Virtual Network<br/>10.0.0.0/16]
    SubnetWeb[Web Subnet<br/>10.0.1.0/24]
    SubnetApp[App Subnet<br/>10.0.2.0/24]
    SubnetData[Data Subnet<br/>10.0.3.0/24]
    
    NSGWeb[NSG-Web]
    NSGApp[NSG-App]
    NSGData[NSG-Data]
    
    Internet -->|HTTPS:443| SubnetWeb
    VNet --> SubnetWeb
    VNet --> SubnetApp
    VNet --> SubnetData
    
    SubnetWeb -.->|Protected by| NSGWeb
    SubnetApp -.->|Protected by| NSGApp
    SubnetData -.->|Protected by| NSGData
```


### 6. Cost Analysis

Provide estimated monthly costs:

| Resource | Type | SKU/Tier | Estimated Monthly Cost | Cost Optimization Notes |
|----------|------|----------|----------------------|------------------------|
| (for each resource) | | | | |

**Total Estimated Monthly Cost**: $X,XXX

#### Cost Optimization Opportunities
- Reserved Instances: Potential savings for compute resources
- Right-sizing: Resources that could be downsized
- Auto-shutdown: Non-prod resources that could be shut down outside business hours
- Storage tiering: Cold/Archive storage for infrequent access
- Spot instances: For fault-tolerant workloads


### 7. Security & Compliance

Document security configurations:
- **Authentication**: Managed Identity, Entra ID integration
- **Authorization**: RBAC roles, access policies
- **Encryption**: At-rest (TDE, Storage encryption), in-transit (TLS)
- **Secrets Management**: Key Vault usage, connection strings
- **Network Security**: Private endpoints, NSG rules, firewalls
- **Monitoring & Auditing**: Diagnostic logs, Azure Monitor, alerts

### 8. Disaster Recovery & Business Continuity

Document DR strategy:
- **Backup Configuration**: Automated backups, retention policies
- **Recovery Objectives**:
  - RTO (Recovery Time Objective): Target time to restore
  - RPO (Recovery Point Objective): Acceptable data loss window
- **Failover Procedures**: Steps to switch to DR environment
- **Testing Schedule**: Regular DR drills

### 9. Monitoring & Observability

Document monitoring setup:
- **Application Insights**: Telemetry, traces, exceptions
- **Log Analytics**: Centralized logging, log queries
- **Alerts**: Critical metrics and thresholds
- **Dashboards**: Key metrics visualization
- **Health Checks**: Availability tests, endpoint monitoring

### 10. Dependencies & Integrations

Document external dependencies:
- **Azure Services**: Dependencies on other Azure services
- **Third-Party Services**: External APIs, SaaS integrations
- **On-Premises**: Hybrid connections, VPN/ExpressRoute
- **Data Sources**: External data feeds, databases

### 11. Deployment & Operations

Document operational procedures:
- **Deployment Method**: IaC (Bicep/Terraform), Azure Portal, ARM
- **CI/CD Pipeline**: Build and deployment automation
- **Configuration Management**: App settings, environment variables
- **Scaling Procedures**: Manual and automatic scaling
- **Maintenance Windows**: Scheduled maintenance, patching

## Output Format

- Use **Markdown** with clear headers and sections
- Include **Mermaid diagrams** for visual representation
- Use **tables** for structured data (inventory, costs, NSG rules)
- Provide **actionable** information (not just descriptions)
- Include **real resource names** from the inventory above
- Add **links** to Azure documentation where relevant

## Additional Guidelines

- Focus on **clarity and completeness**
- Assume the audience is technical (IT Pros, architects, engineers)
- Highlight **security and compliance** aspects
- Emphasize **cost optimization** opportunities
- Include **operational considerations** (monitoring, maintenance)
- Make it **actionable** (procedures, not just descriptions)

---

Please generate complete architecture documentation following this structure. Make it comprehensive yet practical for use by operations teams and new team members.
